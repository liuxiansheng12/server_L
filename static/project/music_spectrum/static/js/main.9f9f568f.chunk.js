(this.webpackJsonpmusic_spectrum=this.webpackJsonpmusic_spectrum||[]).push([[0],[,,,,function(e,t,n){e.exports=n(17)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(3),u=n.n(r),i=n(1);n(9);var o={ajax:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,a){var c=new XMLHttpRequest;c.open("GET",e,!0),c.send(),t.responseType&&(c.responseType=t.responseType),c.onreadystatechange=function(){if(4===c.readyState&&200===c.status){var e=c.response;n(e)}}}))},url:""};var s={downAjax:function(e,t){o.ajax(o.url+"/kuwo/api/www/search/searchKey?key=".concat(e)).then((function(e){var n=JSON.parse(e).data;t(function(e){var t=[];return e.forEach((function(e){var n=e.split("\r\n")[0].split("=");1===n.length?t.push(n[0]):2===n.length&&t.push(n[1])})),t}(n))}))}},l=c.a.createContext();var f=function(){var e=Object(a.useState)(""),t=Object(i.a)(e,2),n=t[0],r=t[1],u=Object(a.useState)([]),o=Object(i.a)(u,2),f=o[0],m=o[1],F=Object(a.useState)(!1),C=Object(i.a)(F,2),d=C[0],p=C[1],v=Object(a.useContext)(l);return Object(a.useEffect)((function(){window.onclick=function(){p(!1)}}),[]),c.a.createElement("div",{className:"search",onClick:function(e){e.stopPropagation()}},c.a.createElement("div",{className:"int"},c.a.createElement("input",{onChange:function(e){r(e.target.value),p(!0),s.downAjax(n,(function(e){m(e)}))},onClick:function(){p(!0)},value:n}),c.a.createElement("div",{className:"btn"},"\u641c\u7d22")),c.a.createElement("ul",{className:"down",onClick:function(){p(!1)},style:{display:n&&d?"block":"none"}},function(e,t,n){return e.map((function(e,a){return c.a.createElement("li",{key:a,onClick:function(){t(e),console.log(n),n.playBoo&&n.playBoo(!1),setTimeout((function(){n.singerId&&n.singerId(null),n.inputKey&&n.inputKey(e)}))}},e)}))}(f,r,v)))};n(10);var m=function(e){var t,n,r,u,o=Object(a.useState)([]),s=Object(i.a)(o,2),l=s[0],f=s[1];return Object(a.useEffect)((function(){f(function(e,t){if(!e||!t)return[];var n=["<"];if(e<=7)for(var a=1;a<=e;a++)n.push(a);else n=e>7&&t<=5?["<",1,2,3,4,5,"\xb7\xb7\xb7",e]:e>7&&t>=e-4?["<",1,"\xb7\xb7\xb7",e-4,e-3,e-2,e-1,e]:["<",1,"\xb7\xb7\xb7",t-1,t,t+1,"\xb7\xb7\xb7",e];return n.push(">"),n}(e.zong,e.index))}),[e.zong,e.index]),e.index>e.zong&&e.callBack(1),c.a.createElement("div",{className:"footer"},c.a.createElement("div",{className:"footer_content"},(t=l,n=e.index,r=e.zong,u=e.callBack,t.map((function(e,t){return c.a.createElement("span",{onClick:function(){"<"===e&&n>1?u(n-1):">"===e&&n<r?u(n+1):"\xb7\xb7\xb7"!==e&&u(e)},key:t,className:e==n?"active":""},e)})))))};n(11);var F={singerAjax:function(e,t,n,a){o.ajax(o.url+"/kuwo/api/www/artist/artistInfo?category=0&pn=".concat(e,"&rn=").concat(30)).then((function(e){a.current&&(a.current.scrollTop=0);var c=JSON.parse(e).data,r=parseInt(c.total/30);30*r<c.total&&(r+=1),t(r),n(c.artistList)}))}};var C=function(){var e=Object(a.useState)(1),t=Object(i.a)(e,2),n=t[0],r=t[1],u=Object(a.useState)(1),o=Object(i.a)(u,2),s=o[0],f=o[1],C=Object(a.useState)([]),d=Object(i.a)(C,2),p=d[0],v=d[1],j=Object(a.useRef)(),b=Object(a.useContext)(l);return Object(a.useEffect)((function(){F.singerAjax(n,f,v,j)}),[n]),c.a.createElement("div",{className:"singer"},c.a.createElement("div",{className:"singer_content",ref:j},function(e,t){return e.map((function(e){return c.a.createElement("div",{className:"singer_d",key:e.id,onClick:function(){t.playBoo&&t.playBoo(!1),setTimeout((function(){t.singerId&&t.singerId(e.id),t.inputKey&&t.inputKey(null)}))}},c.a.createElement("img",{src:e.pic70}),c.a.createElement("div",null,e.name))}))}(p,b)),c.a.createElement("div",{className:"singer_footer"},c.a.createElement(m,{zong:s,index:n,callBack:function(e){r(e)}})))};n(12);var d={informationAjax:function(e,t,n,a,c,r){var u=o.url+"/kuwo/api/www";t?e||(u+="/search/searchMusicBykeyWord?key=".concat(t,"&pn=").concat(n,"&rn=30")):u+="/artist/artistMusic?artistid=".concat(e,"&pn=").concat(n,"&rn=30"),o.ajax(u).then((function(e){r.current&&(r.current.scrollTop=0);var t=JSON.parse(e).data;a(t.list);var n=parseInt(t.total/30);30*n<t.total&&(n+=1),c(n)}))}};var p=function(){var e=Object(a.useContext)(l),t=Object(a.useState)(null),n=Object(i.a)(t,2),r=n[0],u=n[1],o=Object(a.useState)(null),s=Object(i.a)(o,2),f=s[0],F=s[1],C=Object(a.useState)(1),p=Object(i.a)(C,2),v=p[0],j=p[1],b=Object(a.useState)(1),O=Object(i.a)(b,2),E=O[0],y=O[1];Object(a.useEffect)((function(){e.singerId=u,e.inputKey=F}),[]);var g=Object(a.useState)([]),h=Object(i.a)(g,2),w=h[0],x=h[1],k=Object(a.useRef)();return Object(a.useEffect)((function(){(r||f)&&d.informationAjax(r,f,v,x,y,k)}),[r,v,f]),c.a.createElement("div",{className:"information"},c.a.createElement("div",{className:"information_content",ref:k},function(e,t,n){return e.map((function(e,a){return c.a.createElement("div",{className:"content",key:a,onClick:function(){t.playBoo(!0),setTimeout((function(){t.musicId(e.rid)}))}},c.a.createElement("div",{className:"list"},a+1+30*(n-1)),c.a.createElement("img",{src:e.pic}),c.a.createElement("div",{className:"musicName"},e.name),c.a.createElement("div",{className:"name"},e.artist))}))}(w,e,v)),c.a.createElement("div",{className:"information_footer"},c.a.createElement(m,{zong:E,index:v,callBack:function(e){j(e)}})))};n(13);var v={lrcAjax:function(e,t){var n=o.url+"/kuwo/newh5/singles/songinfoandlrc?musicId=".concat(e);o.ajax(n).then((function(e){var n=JSON.parse(e).data.lrclist;t(n)}))}};function j(e,t,n){if(0===n&&0===e)return!0;var a=t[e].time;if(e===t.length-1&&a<=n)return!0;if(e===t.length-1)return!1;var c=t[e+1].time;return a<=n&&c>n}function b(e){return e<=2?"-0px":30*-(e-2)+"px"}var O=function(e){var t=Object(a.useState)([]),n=Object(i.a)(t,2),r=n[0],u=n[1];Object(a.useEffect)((function(){e.musicId&&v.lrcAjax(e.musicId,u)}),[e.musicId]);var o,s=function(e,t){if(0===e.length)return 0;for(var n=0;n<e.length;n++)if(j(n,e,t))return n}(r,e.time);return c.a.createElement("div",{className:"lrc"},c.a.createElement("div",{className:"content",style:{marginTop:b(s)}},(o=s,r.map((function(e,t){return c.a.createElement("div",{key:t,style:{color:t===o?"#f0f":"#666"}},e.lineLyric)})))))},E=(n(14),[]),y=null,g=[],h=["#990033","#CC6699","#FF6699","#FF3366","#993366","#CC0066","#CC0033","#FF0066","#FF0033","#CC3399","#FF3399","#FF9999","#FF99CC","#FF0099","#CC3366","#FF66CC","#FF33CC","#FFCCFF","#FF99FF","#FF00CC","#FF66FF","#CC33CC","#CC00FF","#FF33FF","#CC99FF","#9900CC","#FF00FF","#CC66FF","#990099","#CC0099","#CC33FF","#CC99CC","#990033","#CC6699","#FF6699","#FF3366","#993366","#CC0066","#CC0033","#FF0066","#FF0033","#CC3399","#FF3399","#FF9999","#FF99CC","#FF0099","#CC3366","#FF66CC","#FF33CC","#FFCCFF","#FF99FF","#FF00CC","#FF66FF","#CC33CC","#CC00FF","#FF33FF","#CC99FF","#9900CC","#FF00FF","#CC66FF","#990099","#CC0099","#CC33FF","#CC99CC"];function w(e,t){var n=E[t];return(!n||n<e)&&((n=1.1*e)>=297&&(n=297),E[t]=n),g[t]=e,{background:h[h.length-1-t],bottom:n+"px"}}var x=function(e){Object(a.useEffect)((function(){document.querySelectorAll(".tou")})),Object(a.useEffect)((function(){return(E=[]).fill(0),g=[],y=setInterval((function(){for(var e=0;e<E.length;e++){if(!E[e])return;var t=E[e]-2;E[e]=t}}),20),function(){clearInterval(y)}}),[]);for(var t=e.frequency,n=[],r=0;r<t.length;r++)0===t[r]?n.push(parseInt(10*Math.random())+3):n.push(t[r]);var u=function(e){return e.map((function(e,t){return c.a.createElement("div",{className:"fre_content",key:t},c.a.createElement("div",{className:"tou",style:w(e,t)}),c.a.createElement("div",{className:"zhu",style:{height:e+"px",background:h[t]}}))}))}(n);return c.a.createElement("div",{className:"frequency"},u)};n(15);var k={musicAjax:function(e,t,n){var a=null,c=null;return new Promise((function(r){var u=o.url+"/kuwo/api/www/music/musicInfo?mid=".concat(e);o.ajax(u).then((function(e){a=JSON.parse(e).data})).then((function(){var e=o.url+"/kuwo/url?format=mp3&rid=".concat(a.rid,"&response=url&type=convert_url3&br=128kmp3&from=web");return o.ajax(e)})).then((function(e){c=JSON.parse(e).url})).then((function(){t(a),n(c),r(c)}))}))},music:function(e,t,n,a,c){var r=null,u=null,i=null,s=!1,l=null,f=[],m=null,F=0,C=!1;function d(e){C=!1,o.ajax(e,{responseType:"arraybuffer"}).then((function(e){(function(){var e=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext;r=new e})(),u=r.createBufferSource(),(i=r.createAnalyser()).smoothingTimeConstant=.1,i.fftSize=64,u.connect(i),i.connect(r.destination),f=new Uint8Array(i.frequencyBinCount),r.decodeAudioData(e,(function(e){l=e,u.buffer=l,C=!0,n(),c&&p()}),(function(e){console.log(e.err)}))}))}function p(){C&&(s?r.resume():(F=-r.currentTime,u.start(0),s=!0),m=setInterval((function(){var e;i.getByteFrequencyData(f),u.buffer&&(r.currentTime+F>u.buffer.duration&&(F=-r.currentTime,e=0,u.stop(0),(u=r.createBufferSource()).buffer=l,u.connect(i),u.start(0,e),F+=e),t(f,r.currentTime+F,u.buffer.duration))}),100))}return d(e),{play:p,suspend:function(){C&&(r.suspend(),clearInterval(m))},stop:function(){u.stop(0),s=!1,clearInterval(m),a&&a()}}}},N=null;var S=function(){var e=Object(a.useState)(null),t=Object(i.a)(e,2),n=t[0],r=t[1],u=Object(a.useState)({}),o=Object(i.a)(u,2),s=o[0],f=o[1],m=Object(a.useState)(null),F=Object(i.a)(m,2)[1],C=Object(a.useState)(!1),d=Object(i.a)(C,2),p=d[0],v=d[1],j=Object(a.useState)(!1),b=Object(i.a)(j,2),E=b[0],y=b[1],g=Object(a.useState)(0),h=Object(i.a)(g,2),w=h[0],S=h[1],I=Object(a.useState)([]),A=Object(i.a)(I,2),B=A[0],T=A[1],_=Object(a.useContext)(l);return Object(a.useEffect)((function(){_.musicId=r}),[]),Object(a.useEffect)((function(){return n&&function(e,t,n){return new Promise((function(a,c){N=null,k.musicAjax(e,t,n).then((function(e){a(e)}))}))}(n,f,F).then((function(e){!function(e,t,n,a,c){N=k.music("/musicPlay/kuwo?url="+e,(function(e,t,n){a(t),c(e)}),(function(){n(!0)}),(function(){console.log("\u97f3\u4e50\u64ad\u653e\u7ed3\u675f")}),t)}(e,E,v,S,T)})),function(){N&&N.stop()}}),[n]),c.a.createElement("div",{className:"play"},c.a.createElement("div",{className:"btn",onClick:function(){!function(e,t,n){if(!N||!t)return;e?(n(!1),N.suspend()):(n(!0),N.play())}(E,p,y)}},!p&&"\u97f3\u4e50\u52a0\u8f7d\u4e2d\uff0c\u7981\u6b62\u64cd\u4f5c",p&&!E&&"\u64ad\u653e\u97f3\u4e50",p&&E&&"\u6682\u505c\u97f3\u4e50"),c.a.createElement(x,{frequency:B}),c.a.createElement(O,{musicId:s.rid,time:w}))},I={inputKey:null,singerId:null,musicId:null,playBoo:null};var A=function(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){I.playBoo=r}),[]),c.a.createElement(l.Provider,{value:I},c.a.createElement("div",{className:"app_content"},c.a.createElement(f,null),c.a.createElement("div",{className:"infor"},c.a.createElement(C,null),!n&&c.a.createElement(p,null),n&&c.a.createElement(S,null))))};n(16);u.a.render(c.a.createElement(A,null),document.querySelector("#app"))}],[[4,1,2]]]);
//# sourceMappingURL=main.9f9f568f.chunk.js.map